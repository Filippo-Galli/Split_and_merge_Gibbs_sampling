split_merge = TRUE)
Rcpp::sourceCpp("../code/neal_sampler.cpp")
#sink("output.txt")
run <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = 10,
c_i = unlist(groundTruth),
#c_i = rep(0,101),
#c_i = seq(1,101),
burnin = 0,
t = 2,
r = 2,
neal8 = FALSE,
split_merge = TRUE)
#sink()
L_plurale <- c(7)
Rcpp::sourceCpp("../code/neal_sampler.cpp")
#sink("output.txt")
run <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = 10,
c_i = unlist(groundTruth),
#c_i = rep(0,101),
#c_i = seq(1,101),
burnin = 0,
t = 2,
r = 2,
neal8 = FALSE,
split_merge = TRUE)
Rcpp::sourceCpp("../code/neal_sampler.cpp")
#sink()
L_plurale <- c(7)
iterations <- 1000
burnin <- 0
#sink("output.txt")
run <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = 10,
c_i = unlist(groundTruth),
#c_i = rep(0,101),
#c_i = seq(1,101),
burnin = burnin,
t = 2,
r = 2,
neal8 = FALSE,
split_merge = TRUE)
table(run$c_i)
Rcpp::sourceCpp("../code/neal_sampler.cpp")
Rcpp::sourceCpp("../code/neal_sampler.cpp")
#sink("output.txt")
run <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = 10,
c_i = unlist(groundTruth),
#c_i = rep(0,101),
#c_i = seq(1,101),
burnin = burnin,
t = 2,
r = 2,
neal8 = FALSE,
split_merge = TRUE)
Rcpp::sourceCpp("../code/neal_sampler.cpp")
iterations <- 1
#sink("output.txt")
run <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = 10,
c_i = unlist(groundTruth),
#c_i = rep(0,101),
#c_i = seq(1,101),
burnin = burnin,
t = 2,
r = 2,
neal8 = FALSE,
split_merge = TRUE)
run$final_ass
Rcpp::sourceCpp("../code/neal_sampler.cpp")
#sink("output.txt")
run <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = 10,
c_i = unlist(groundTruth),
#c_i = rep(0,101),
#c_i = seq(1,101),
burnin = burnin,
t = 2,
r = 2,
neal8 = FALSE,
split_merge = TRUE)
run$final_ass
Rcpp::sourceCpp("../code/neal_sampler.cpp")
#sink("output.txt")
run <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = 10,
c_i = unlist(groundTruth),
#c_i = rep(0,101),
#c_i = seq(1,101),
burnin = burnin,
t = 2,
r = 2,
neal8 = FALSE,
split_merge = TRUE)
iterations <- 1000
#sink("output.txt")
run <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = 10,
c_i = unlist(groundTruth),
#c_i = rep(0,101),
#c_i = seq(1,101),
burnin = burnin,
t = 2,
r = 2,
neal8 = FALSE,
split_merge = TRUE)
table(run$final_ass)
#sink("output.txt")
run <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = 10,
#c_i = unlist(groundTruth),
c_i = rep(0,101),
#c_i = seq(1,101),
burnin = burnin,
t = 2,
r = 2,
neal8 = FALSE,
split_merge = TRUE)
table(run$final_ass)
#sink("output.txt")
run <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = 10,
#c_i = unlist(groundTruth),
#c_i = rep(0,101),
c_i = seq(1,101),
burnin = burnin,
t = 2,
r = 2,
neal8 = FALSE,
split_merge = TRUE)
table(run$final_ass)
library(AntMAN)
library(mcclust.ext)
library(ggplot2)
library(tidyverse)
source("../code/complement_functions.R")
#=========================================================================================
# Loading data
#=========================================================================================
zoo=read.table("../data/zoo.data", h=F, sep=",")
nam = zoo$V1
groundTruth = zoo$V18
#classes = factor(groundTruth,labels=c("mammals", "birds", "reptiles", "fish",
#"amphibians", "insects", "mollusks"))
#names(groundTruth)<-classes
#=========================================================================================
# Data cleaning
#=========================================================================================
zoo = as.matrix(zoo[,-c(1,18)]+1)
zoo[,13] = ifelse(zoo[,13]==3,2,
ifelse(zoo[,13]==5,3,
ifelse(zoo[,13]==6,4,
ifelse(zoo[,13]==7,5,
ifelse(zoo[,13]==9,6,
1)))))
n = nrow(zoo)
p = ncol(zoo)
mm = apply(zoo, 2, function(x){length(table(x))})
#=========================================================================================
# Neal sampler
#=========================================================================================
## Obbligatorie per Filippo perchÃ© RcppGSL non trova le librerie GSL e nemmeno RcppGSL.h
# First, use the explicit include path from RcppGSL
Sys.setenv("PKG_CXXFLAGS" = paste0("-I/home/filippo/R/x86_64-pc-linux-gnu-library/4.4/RcppGSL/include",
" -I/usr/local/include", "-O3 -Wall -Wextra -pedantic"))
Sys.setenv("PKG_CXXFLAGS" = paste0('-I"C:/Users/clau7/AppData/Local/R/win-library/4.4/RcppGSL/include"',
" -I/usr/local/include"))
# Include full library paths and libraries
Sys.setenv("PKG_LIBS" = "-L/usr/local/lib -lgsl -lgslcblas -lm")
v = c(rep(6,12),3,rep(6,3))
w = c(rep(0.25,12),0.5,rep(0.25,3))
zoo.subset <- zoo[which(unlist(groundTruth) %in% c(1,2)),]
groundTruth.subset <- unlist(groundTruth)[which(unlist(groundTruth) %in% c(1,2))]
L_plurale <- c(7)
iterations <- 10
burnin <- 0
m <- 3
n <- 61
Rcpp::sourceCpp("../code/neal_sampler.cpp")
for(l in L_plurale){
temp_time <- format(Sys.time(), "%Y%m%d_%H%M%S")
result_name = "result_"
sink("output.txt")
results <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = l,
c_i = unlist(groundTruth),
#c_i = rep(0,61),
#c_i = seq(1,61),
burnin = burnin,
t = 1,
r = 1,
neal8 = FALSE,
split_merge = TRUE)
sink()
result_name = paste(result_name, "init_ass_", sep="")
# Save results
filename <- paste("../results/", result_name, l, "_",m, "_", iterations,"_",temp_time,".RData", sep = "")
save(results, file = filename)
print(paste("Results for L = ", l, " saved in ", filename, sep = ""))
}
unlist(groundTruth)
zoo.nrow()
nrow(zoo)
Rcpp::sourceCpp("../code/neal_sampler.cpp")
for(l in L_plurale){
temp_time <- format(Sys.time(), "%Y%m%d_%H%M%S")
result_name = "result_"
sink("output.txt")
results <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = l,
#c_i = unlist(groundTruth),
c_i = rep(0,nrow(zoo)),
#c_i = seq(1,nrow(zoo)),
burnin = burnin,
t = 1,
r = 1,
neal8 = FALSE,
split_merge = TRUE)
sink()
result_name = paste(result_name, "init_ass_", sep="")
# Save results
filename <- paste("../results/", result_name, l, "_",m, "_", iterations,"_",temp_time,".RData", sep = "")
save(results, file = filename)
print(paste("Results for L = ", l, " saved in ", filename, sep = ""))
}
unlist(groundTruth)-1
zoo.subset <- zoo[which(unlist(groundTruth) %in% c(1,2,3)),]
groundTruth.subset <- unlist(groundTruth)[which(unlist(groundTruth) %in% c(1,2,3))]
zoo <- zoo.subset
groundTruth <- groundTruth.subset
Rcpp::sourceCpp("../code/neal_sampler.cpp")
for(l in L_plurale){
temp_time <- format(Sys.time(), "%Y%m%d_%H%M%S")
result_name = "result_"
sink("output.txt")
results <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = l,
#c_i = unlist(groundTruth),
c_i = rep(0,nrow(zoo)),
#c_i = seq(1,nrow(zoo)),
burnin = burnin,
t = 1,
r = 1,
neal8 = FALSE,
split_merge = TRUE)
sink()
result_name = paste(result_name, "init_ass_", sep="")
# Save results
filename <- paste("../results/", result_name, l, "_",m, "_", iterations,"_",temp_time,".RData", sep = "")
save(results, file = filename)
print(paste("Results for L = ", l, " saved in ", filename, sep = ""))
}
unlist(groundTruth) -1
iterations <- 1000
burnin <- 0
m <- 3
n <- 61
zoo <- zoo.subset
groundTruth <- groundTruth.subset
Rcpp::sourceCpp("../code/neal_sampler.cpp")
for(l in L_plurale){
temp_time <- format(Sys.time(), "%Y%m%d_%H%M%S")
result_name = "result_"
sink("output.txt")
results <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = l,
#c_i = unlist(groundTruth),
c_i = rep(0,nrow(zoo)),
#c_i = seq(1,nrow(zoo)),
burnin = burnin,
t = 1,
r = 1,
neal8 = FALSE,
split_merge = TRUE)
sink()
result_name = paste(result_name, "init_ass_", sep="")
# Save results
filename <- paste("../results/", result_name, l, "_",m, "_", iterations,"_",temp_time,".RData", sep = "")
save(results, file = filename)
print(paste("Results for L = ", l, " saved in ", filename, sep = ""))
}
table(results$final_ass)
table(unlist(groundTruth))
results$accepted
Rcpp::sourceCpp("../code/neal_sampler.cpp")
for(l in L_plurale){
temp_time <- format(Sys.time(), "%Y%m%d_%H%M%S")
result_name = "result_"
sink("output.txt")
results <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = l,
#c_i = unlist(groundTruth),
#c_i = rep(0,nrow(zoo)),
c_i = seq(1,nrow(zoo)),
burnin = burnin,
t = 1,
r = 1,
neal8 = FALSE,
split_merge = TRUE)
sink()
result_name = paste(result_name, "init_ass_", sep="")
# Save results
filename <- paste("../results/", result_name, l, "_",m, "_", iterations,"_",temp_time,".RData", sep = "")
save(results, file = filename)
print(paste("Results for L = ", l, " saved in ", filename, sep = ""))
}
table(results$final_ass)
table(unlist(groundTruth))
results$accepted
results$merge_n
Rcpp::sourceCpp("../code/neal_sampler.cpp")
Rcpp::sourceCpp("../code/neal_sampler.cpp")
for(l in L_plurale){
temp_time <- format(Sys.time(), "%Y%m%d_%H%M%S")
result_name = "result_"
sink("output.txt")
results <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = l,
#c_i = unlist(groundTruth),
#c_i = rep(0,nrow(zoo)),
c_i = seq(1,nrow(zoo)),
burnin = burnin,
t = 5,
r = 5,
neal8 = FALSE,
split_merge = TRUE)
sink()
result_name = paste(result_name, "init_ass_", sep="")
# Save results
filename <- paste("../results/", result_name, l, "_",m, "_", iterations,"_",temp_time,".RData", sep = "")
save(results, file = filename)
print(paste("Results for L = ", l, " saved in ", filename, sep = ""))
}
results$accepted_merge
results$accepted_split
unlist(groundTruth)
table(results$final_ass)
results$merge_n
Rcpp::sourceCpp("../code/neal_sampler.cpp")
for(l in L_plurale){
temp_time <- format(Sys.time(), "%Y%m%d_%H%M%S")
result_name = "result_"
sink("output.txt")
results <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = l,
#c_i = unlist(groundTruth),
c_i = rep(0,nrow(zoo)),
#c_i = seq(1,nrow(zoo)),
burnin = burnin,
t = 5,
r = 5,
neal8 = FALSE,
split_merge = TRUE)
sink()
result_name = paste(result_name, "init_ass_", sep="")
# Save results
filename <- paste("../results/", result_name, l, "_",m, "_", iterations,"_",temp_time,".RData", sep = "")
save(results, file = filename)
print(paste("Results for L = ", l, " saved in ", filename, sep = ""))
}
results$split_n
table(results$final_ass)
Rcpp::sourceCpp("../code/neal_sampler.cpp")
for(l in L_plurale){
temp_time <- format(Sys.time(), "%Y%m%d_%H%M%S")
result_name = "result_"
sink("output.txt")
results <- run_markov_chain(data = zoo,
attrisize = mm,
gamma = 0.68,
v = v,
w = w,
verbose = 0,
m = m,
iterations = iterations,
L = l,
c_i = unlist(groundTruth),
#c_i = rep(0,nrow(zoo)),
#c_i = seq(1,nrow(zoo)),
burnin = burnin,
t = 5,
r = 5,
neal8 = FALSE,
split_merge = TRUE)
sink()
result_name = paste(result_name, "init_ass_", sep="")
# Save results
filename <- paste("../results/", result_name, l, "_",m, "_", iterations,"_",temp_time,".RData", sep = "")
save(results, file = filename)
print(paste("Results for L = ", l, " saved in ", filename, sep = ""))
}
